
ï»¿
function ResultsWorker(){var thisObj=this;this.sigmaX=100;this.sigmaY=0;var __tau=30;Object.defineProperty(this,"tau",{get:function(){return __tau;}});Object.defineProperty(this,"tauX",{get:function(){return-1*__tau;}});Object.defineProperty(this,"tauY",{get:function(){return __tau;}});var __elemRotDeg=0;Object.defineProperty(this,"angleX",{get:function(){return __elemRotDeg;}});Object.defineProperty(this,"angleY",{get:function(){return __elemRotDeg+90;}});this.init=function(){this.counter=0;this.maxCount=10;this.txtStressX=document.getElementById("txtStressX");this.txtStressY=document.getElementById("txtStressY");this.txtStressShear=document.getElementById("txtStressShear");this.slider=document.getElementById("sliderAngle");this.lblAngle=document.getElementById("lblAngle");this.divMohrCanvas=document.getElementById("divMohrCanvas");this.divMohrUniformPrincMsg=document.getElementById("divMohrUniformPrincMsg");this.divWarn_Stress=document.getElementById("divWarnStress");this.txtWarn_Stress=document.getElementById("txtWarnStress");this.divWarn_Count=document.getElementById("divWarnCount");this.txtWarn_Count=document.getElementById("txtWarnCount");this.txtStressX.value=this.sigmaX;this.txtStressY.value=this.sigmaY;this.txtStressShear.value=__tau;this.slider.value=__elemRotDeg;this.lblAngle.innerHTML=this.slider.value;this.txtStressX.onchange=this.onChange_txtStressX;this.txtStressY.onchange=this.onChange_txtStressY;this.txtStressShear.onchange=this.onChange_txtStressShear;this.slider.onchange=this.onChange_Slider;this.slider.oninput=this.onChange_Slider;this.slider.onkeydown=this.onKeyDown_Slider;this.updateResults();}
this.validateStressInputs=function(sigmaX,sigmaY,tau){this.divMohrCanvas.setVisible(true);this.divMohrUniformPrincMsg.setVisible(false);if(Math.abs(sigmaX)+Math.abs(sigmaY)+Math.abs(tau)===0){thisObj.setStressWarning('Stress values cannot all be 0!');return false;}else if(sigmaX===sigmaY&&tau===0){this.divMohrCanvas.setVisible(false);this.divMohrUniformPrincMsg.setVisible(true);return true;}
return true;}
this.onChange_txtStressX=function(){var inputForm=new RL.Form.Form({'stress':new RL.Form.Field('txtStressX',[new RL.Form.Validator.Numeric()])});if(inputForm.validate()){thisObj.clearStressWarning();thisObj.counter=0;thisObj.clearCountWarning();var formValues=inputForm.getValues();var stress=Number(formValues.stress);if(thisObj.validateStressInputs(stress,thisObj.sigmaY,thisObj.tau)){thisObj.sigmaX=stress;thisObj.updateResults();}}}
this.onChange_txtStressY=function(){var inputForm=new RL.Form.Form({'stress':new RL.Form.Field('txtStressY',[new RL.Form.Validator.Numeric()])});if(inputForm.validate()){thisObj.clearStressWarning();thisObj.counter=0;thisObj.clearCountWarning();var formValues=inputForm.getValues();var stress=Number(formValues.stress);if(thisObj.validateStressInputs(thisObj.sigmaX,stress,thisObj.tau)){thisObj.sigmaY=stress;thisObj.updateResults();}}}
this.onChange_txtStressShear=function(){var inputForm=new RL.Form.Form({'stress':new RL.Form.Field('txtStressShear',[new RL.Form.Validator.Numeric()])});if(inputForm.validate()){thisObj.clearStressWarning();thisObj.counter=0;thisObj.clearCountWarning();var formValues=inputForm.getValues();var stress=Number(formValues.stress);if(thisObj.validateStressInputs(thisObj.sigmaX,thisObj.sigmaY,stress)){__tau=stress;thisObj.updateResults();}}}
this.onChange_Slider=function(event){if(thisObj.counter<thisObj.maxCount){var sliderValue=Number(thisObj.slider.value);if(__elemRotDeg!==sliderValue){__elemRotDeg=sliderValue;thisObj.lblAngle.innerHTML=thisObj.slider.value;thisObj.updateResults();if(userLoggedIn()){thisObj.counter+=1;}}}else{thisObj.setCountWarning();}}
this.onKeyDown_Slider=function(event){if(event.repeat){event.preventDefault();event.stopPropagation();}}
this.setStressWarning=function(msg){this.divWarn_Stress.setVisible(true);this.txtWarn_Stress.innerHTML=msg;}
this.clearStressWarning=function(){this.divWarn_Stress.setVisible(false);this.txtWarn_Stress.innerHTML='';}
this.setCountWarning=function(){var warnAlreadyShown=this.divWarn_Count.isVisible();this.divWarn_Count.setVisible(true);this.txtWarn_Count.innerHTML='Please log in to remove the limit on element rotation.';var flashFunc=function(){var borderColor=thisObj.txtWarn_Count.style.borderColor==='crimson'?'white':'crimson';thisObj.txtWarn_Count.style.borderColor=borderColor;}
if(!warnAlreadyShown){var maxCount=6;RL.TimedCode.runAtInterval(flashFunc,500,maxCount);}}
this.clearCountWarning=function(){this.divWarn_Count.setVisible(false);this.txtWarn_Count.innerHTML='';}
this.getExtremeValues=function(){var sigmaAvg=(this.sigmaX+this.sigmaY)/2;var R=Math.sqrt(Math.pow((this.sigmaX-this.sigmaY)/2,2)+Math.pow(this.tau,2));var prinStressMax=sigmaAvg+R;var prinStressMin=sigmaAvg-R;var angleRad1=0.5*Math.atan2(2*this.tau,(this.sigmaX-this.sigmaY));var angleRad2=angleRad1+(Math.PI/2);var angleDeg1=RL.Number.degrees(angleRad1);var angleDeg2=RL.Number.degrees(angleRad2);var stress1=this.getTransformedStress(angleDeg1);var stress2=this.getTransformedStress(angleDeg2);var angleDeg_MaxPrin='---';var angleDeg_MinPrin='---';var thresh=0.01*Math.abs(prinStressMax);if(RL.Number.basicallyEqual(stress1.sigmaTheta,prinStressMax,thresh)){angleDeg_MaxPrin=angleDeg1;angleDeg_MinPrin=angleDeg2;}else if(RL.Number.basicallyEqual(stress2.sigmaTheta,prinStressMax,thresh)){angleDeg_MaxPrin=angleDeg2;angleDeg_MinPrin=angleDeg1;}
var angleDeg_MaxShear=angleDeg_MaxPrin+45;var angleDeg_MinShear=angleDeg_MaxShear+90;return{sigmaAvg:sigmaAvg,R:R,prinStressMax:prinStressMax,prinStressMin:prinStressMin,angleDeg_MaxPrin:angleDeg_MaxPrin,angleDeg_MinPrin:angleDeg_MinPrin,shearStressMax:R,shearStressMin:-R,angleDeg_MaxShear:angleDeg_MaxShear,angleDeg_MinShear:angleDeg_MinShear};}
this.getTransformedStress=function(angleDeg){var angleRad=angleDeg*(Math.PI/180);var sigmaTheta=(0.5*(this.sigmaX+this.sigmaY))+(0.5*(this.sigmaX-this.sigmaY)*Math.cos(2*angleRad))+(this.tau*Math.sin(2*angleRad));var tauTheta=(-0.5*(this.sigmaX-this.sigmaY)*Math.sin(2*angleRad))+(this.tau*Math.cos(2*angleRad));return{sigmaTheta:sigmaTheta,tauTheta:tauTheta};}
this.formatResult=function(value){return RL.Number.format_General(value,{zeroThresh:-12});}
this.updateResults=function(){this.updatePlot_MohrsCircle();this.updatePlot_PlaneUnrotated();this.updatePlot_PlaneRotated();this.updatePlot_PlanePrincipalStress();this.updatePlot_PlaneMaxShear();this.updateTable_Results();}
this.updateTable_Results=function(){var trnsStressX=this.getTransformedStress(this.angleX);document.getElementById("resRotStressX").innerHTML=this.formatResult(trnsStressX.sigmaTheta);document.getElementById("resRotAngleX").innerHTML=this.formatResult(this.angleX);document.getElementById("resRotShearStress").innerHTML=this.formatResult(trnsStressX.tauTheta);document.getElementById("resRotShearAngle").innerHTML='---';var trnsStressY=this.getTransformedStress(this.angleY);document.getElementById("resRotStressY").innerHTML=this.formatResult(trnsStressY.sigmaTheta);document.getElementById("resRotAngleY").innerHTML=this.formatResult(this.angleY);var values=this.getExtremeValues();document.getElementById("resMaxPrinStress").innerHTML=this.formatResult(values.prinStressMax);document.getElementById("resMaxPrinAngle").innerHTML=this.formatResult(values.angleDeg_MaxPrin);document.getElementById("resMinPrinStress").innerHTML=this.formatResult(values.prinStressMin);document.getElementById("resMinPrinAngle").innerHTML=this.formatResult(values.angleDeg_MinPrin);document.getElementById("resMaxShear").innerHTML=this.formatResult(values.shearStressMax);document.getElementById("resMaxShearAngle").innerHTML=this.formatResult(values.angleDeg_MaxShear);document.getElementById("resMinShear").innerHTML=this.formatResult(values.shearStressMin);document.getElementById("resMinShearAngle").innerHTML=this.formatResult(values.angleDeg_MinShear);}
var imgSizePX_Planes={width:550,height:350};this.updatePlot_PlaneUnrotated=function(){var canvas=new RL.Canvas(document.getElementById('canvasDiv2'));this.__applyPlot_PlaneUnrotated(canvas);canvas.draw();}
this.getImgStr_PlaneUnrotated=function(){var applyPlot=function(canvas){thisObj.__applyPlot_PlaneUnrotated(canvas);}
return RL.Canvas.get_PNG_ImageStr(imgSizePX_Planes,applyPlot);}
this.__applyPlot_PlaneUnrotated=function(canvas){var angleDeg=0;this.drawPlaneAtAngle(canvas,angleDeg,"Unrotated Element (Black Line in Mohr's Circle)");}
this.updatePlot_PlaneRotated=function(){var canvas=new RL.Canvas(document.getElementById('canvasDiv3'));this.__applyPlot_PlaneRotated(canvas);canvas.draw();}
this.getImgStr_PlaneRotated=function(){var applyPlot=function(canvas){thisObj.__applyPlot_PlaneRotated(canvas);}
return RL.Canvas.get_PNG_ImageStr(imgSizePX_Planes,applyPlot);}
this.__applyPlot_PlaneRotated=function(canvas){var angleDeg=this.angleX;var title='Rotated Element ('+this.formatResult(angleDeg)+' deg)'
this.drawPlaneAtAngle(canvas,angleDeg,title);}
this.updatePlot_PlanePrincipalStress=function(){var canvas=new RL.Canvas(document.getElementById('canvasDiv4'));this.__applyPlot_PlanePrincipalStress(canvas);canvas.draw();}
this.getImgStr_PlanePrincipalStress=function(){var applyPlot=function(canvas){thisObj.__applyPlot_PlanePrincipalStress(canvas);}
return RL.Canvas.get_PNG_ImageStr(imgSizePX_Planes,applyPlot);}
this.__applyPlot_PlanePrincipalStress=function(canvas){var values=this.getExtremeValues();var angleDeg=values.angleDeg_MaxPrin;var title='Element Rotated to Max Principal Stress ('+this.formatResult(angleDeg)+' deg)'
this.drawPlaneAtAngle(canvas,angleDeg,title);}
this.updatePlot_PlaneMaxShear=function(){var canvas=new RL.Canvas(document.getElementById('canvasDiv5'));this.__applyPlot_PlaneMaxShear(canvas);canvas.draw();}
this.getImgStr_PlaneMaxShear=function(){var applyPlot=function(canvas){thisObj.__applyPlot_PlaneMaxShear(canvas);}
return RL.Canvas.get_PNG_ImageStr(imgSizePX_Planes,applyPlot);}
this.__applyPlot_PlaneMaxShear=function(canvas){var values=this.getExtremeValues();var angleDeg=values.angleDeg_MaxShear;var title='Element Rotated to Max Shear Stress ('+this.formatResult(angleDeg)+' deg)'
this.drawPlaneAtAngle(canvas,angleDeg,title);}
this.updatePlot_MohrsCircle=function(){var canvas=new RL.Canvas(document.getElementById('mohrsCircleCanvas'));this.__applyPlot_MohrsCircle(canvas);canvas.draw();}
this.getImgStr_MohrsCircle=function(){var imgSizePX={width:653,height:555};var applyPlot=function(canvas){thisObj.__applyPlot_MohrsCircle(canvas);}
return RL.Canvas.get_PNG_ImageStr(imgSizePX,applyPlot);}
this.__applyPlot_MohrsCircle=function(canvas){if(!this.divMohrCanvas.isVisible()){return;}
canvas.addTitle("Mohr's Circle",{});canvas.options.equalScaleFactors=true;canvas.addMouseCoordinates(undefined,{xDigits:2,yDigits:2,marginPX:0});var sigmaX=this.sigmaX;var sigmaY=this.sigmaY;var tauX=this.tauX;var tauY=this.tauY;var tauFix=-1;var values=this.getExtremeValues();var sigmaAvg=values.sigmaAvg;var R=values.R;var prinStressMax=values.prinStressMax;var prinStressMin=values.prinStressMin;var cntrPt=new RL.Vector2(sigmaAvg,0);canvas.addCircle(cntrPt,2*R,{edgeColor:'Blue',lineWidth:1});var origStressX=this.getTransformedStress(0);var origStressY=this.getTransformedStress(90);var edgePt_X=new RL.Vector2(origStressX.sigmaTheta,tauFix*origStressX.tauTheta);var edgePt_Y=new RL.Vector2(origStressY.sigmaTheta,tauFix*origStressY.tauTheta);canvas.plot({points:{x:[edgePt_X.x,edgePt_Y.x],y:[edgePt_X.y,edgePt_Y.y]},lineOptions:{width:1,color:'Black',style:'solid'},markerOptions:{sizePX:8,color:'Black',style:'o'},legendLabel:'Original Stress'});var trnsStressX=this.getTransformedStress(this.angleX);var trnsStressY=this.getTransformedStress(this.angleY);var edgePt_XPrime=new RL.Vector2(trnsStressX.sigmaTheta,tauFix*trnsStressX.tauTheta);var edgePt_YPrime=new RL.Vector2(trnsStressY.sigmaTheta,tauFix*trnsStressY.tauTheta);canvas.plot({points:{x:[edgePt_XPrime.x,edgePt_YPrime.x],y:[edgePt_XPrime.y,edgePt_YPrime.y]},lineOptions:{width:1,color:'Turquoise',style:'solid'},markerOptions:{sizePX:8,color:'Turquoise',style:'o'},legendLabel:'Transformed Stress'});canvas.plot({points:{x:[prinStressMax,prinStressMin],y:[0,0]},lineOptions:{width:2,color:'FireBrick',style:'--'},markerOptions:{sizePX:8,color:'FireBrick',style:'o'},legendLabel:'Principal Stress'});canvas.plot({points:{x:[sigmaAvg,sigmaAvg],y:[R,-R]},lineOptions:{width:1,color:'Green',style:'--'},markerOptions:{sizePX:8,color:'Green',style:'o'},legendLabel:'Extreme Shear Stress'});try{canvas.set_x_axis({label:'',gridLines:true,ensureOriginShown:true,});canvas.set_y_axis({label:'',gridLines:true,ensureOriginShown:true,});}catch(ex){throw ex;}
canvas.setLegend({anchorPosEnum:RL.Canvas.AnchorPositionEnum.LowerCenter,numCols:2,avoidChart:true});canvas.size.setBoundsAndMargin();var addAxisLabel=function(labelTxt,edgePt){var txtOffsetPX=16;var txtOffsetIN=canvas.posConverter.convertValue_PxToIn(txtOffsetPX);var basePt=cntrPt.interpolate(edgePt,0.92);var txtVect=edgePt.minus(basePt).unitVector(txtOffsetIN);txtVect=txtVect.rotate(90);var ptTxt=basePt.plus(txtVect);canvas.addText(labelTxt,ptTxt,{ha:'center',va:'middle'});}
addAxisLabel('x',edgePt_X);addAxisLabel('y',edgePt_Y);if(Math.abs(this.angleX)>=3){addAxisLabel("x'",edgePt_XPrime);addAxisLabel("y'",edgePt_YPrime);}
if(Math.abs(this.angleX)>=6){var sign=RL.Number.sign(this.angleX);var prop=0.43;var basePt_X=cntrPt.interpolate(edgePt_X,prop);var basePt_XPrime=cntrPt.interpolate(edgePt_XPrime,prop);var arrow=canvas.addCurvedArrow({startPt:basePt_X,endPt:basePt_XPrime,radius:sign*prop*R,headLenPX:9});var arrCntrPt=arrow.getPoints([0.5])[0];var txtPt=cntrPt.interpolate(arrCntrPt,1.17);canvas.addText('2'+RL.Unicode.thetaLower,txtPt,{ha:'center',va:'middle'});}
canvas.addPoint(new RL.Vector2(sigmaAvg,0),{});var txtCntr='('+this.formatResult(sigmaAvg)+', 0.0)';var txtOffsetX_IN=canvas.posConverter.convertValue_PxToIn(6,'X');var txtOffsetY_IN=canvas.posConverter.convertValue_PxToIn(8,'Y');canvas.addText(txtCntr,new RL.Vector2(sigmaAvg+txtOffsetX_IN,txtOffsetY_IN),{sizePX:11,ha:'start',va:'bottom'});var yAxisWidthPX=55;var xAxisHeightPX=25;var yAxisWidthIN=canvas.posConverter.convertValue_PxToIn(yAxisWidthPX,'X');var xAxisHeightIN=canvas.posConverter.convertValue_PxToIn(xAxisHeightPX,'Y');canvas.hitMap.add([new RL.Vector2(-yAxisWidthIN,2*R),new RL.Vector2(0.25*xAxisHeightIN,-2*R)]);canvas.hitMap.add([new RL.Vector2(sigmaAvg-2*R,0.25*xAxisHeightIN),new RL.Vector2(sigmaAvg+2*R,-xAxisHeightIN)]);var annScoringDic={maxDirScore:5,maxAwayCntrScore:10,maxHitMapScore:30,maxBBScore:0,maxNoGrowScore:0};var annTxtMaxPrin='Max prin = '+this.formatResult(prinStressMax);var annMaxPrin=canvas.addAnnotation(annTxtMaxPrin,new RL.Vector2(prinStressMax,0),{textPoint:undefined,textOptions:{sizePX:11},arrowOptions:{headLenPX:9},lengthPX:40,targetOffsetPX:9,updatePosSmart:true,scoringDic:annScoringDic});var annTxtMinPrin='Min prin = '+this.formatResult(prinStressMin);var annMinPrin=canvas.addAnnotation(annTxtMinPrin,new RL.Vector2(prinStressMin,0),{textPoint:undefined,textOptions:{sizePX:11},arrowOptions:{headLenPX:9},lengthPX:40,targetOffsetPX:9,updatePosSmart:true,scoringDic:annScoringDic});var annTxtMaxShear='Max shear = '+this.formatResult(R);var annMaxShear=canvas.addAnnotation(annTxtMaxShear,new RL.Vector2(sigmaAvg,R),{textPoint:undefined,textOptions:{sizePX:11},arrowOptions:{headLenPX:9},dirVect:new RL.Vector2(1,1),lengthPX:40,targetOffsetPX:9,updatePosSmart:true,scoringDic:annScoringDic});var annTxtMinShear='Min shear = '+this.formatResult(-R);var annMinShear=canvas.addAnnotation(annTxtMinShear,new RL.Vector2(sigmaAvg,-R),{textPoint:undefined,textOptions:{sizePX:11},arrowOptions:{headLenPX:9},dirVect:new RL.Vector2(1,1),lengthPX:40,targetOffsetPX:9,updatePosSmart:true,scoringDic:annScoringDic});var annTxtOrig1='('+this.formatResult(origStressX.sigmaTheta)+', '+this.formatResult(tauFix*origStressX.tauTheta)+')';var annOrig1=canvas.addAnnotation(annTxtOrig1,new RL.Vector2(origStressX.sigmaTheta,tauFix*origStressX.tauTheta),{textPoint:undefined,textOptions:{sizePX:11},arrowOptions:{headLenPX:9},lengthPX:50,targetOffsetPX:9,updatePosSmart:true,scoringDic:annScoringDic});var annTxtOrig2='('+this.formatResult(origStressY.sigmaTheta)+', '+this.formatResult(tauFix*origStressY.tauTheta)+')';var annOrig2=canvas.addAnnotation(annTxtOrig2,new RL.Vector2(origStressY.sigmaTheta,tauFix*origStressY.tauTheta),{textPoint:undefined,textOptions:{sizePX:11},arrowOptions:{headLenPX:9},lengthPX:50,targetOffsetPX:9,updatePosSmart:true,scoringDic:annScoringDic});var annTxtRot1='('+this.formatResult(trnsStressX.sigmaTheta)+', '+this.formatResult(tauFix*trnsStressX.tauTheta)+')';var annRot1=canvas.addAnnotation(annTxtRot1,new RL.Vector2(trnsStressX.sigmaTheta,tauFix*trnsStressX.tauTheta),{textPoint:undefined,textOptions:{sizePX:11},arrowOptions:{headLenPX:9},lengthPX:60,targetOffsetPX:9,updatePosSmart:true,scoringDic:annScoringDic});var annTxtRot2='('+this.formatResult(trnsStressY.sigmaTheta)+', '+this.formatResult(tauFix*trnsStressY.tauTheta)+')';var annRot2=canvas.addAnnotation(annTxtRot2,new RL.Vector2(trnsStressY.sigmaTheta,tauFix*trnsStressY.tauTheta),{textPoint:undefined,textOptions:{sizePX:11},arrowOptions:{headLenPX:9},lengthPX:60,targetOffsetPX:9,updatePosSmart:true,scoringDic:annScoringDic});var annObjArr=[annMaxPrin,annMinPrin,annMaxShear,annMinShear,annOrig1,annOrig2,annRot1,annRot2];var annBounds={x_max:0,x_min:0,y_max:0,y_min:0};for(var ii=0;ii<annObjArr.length;ii++){var boundBox=annObjArr[ii].textObj.boundingBox;annBounds.x_max=Math.max(annBounds.x_max,boundBox.x_max);annBounds.x_min=Math.min(annBounds.x_min,boundBox.x_min);annBounds.y_max=Math.max(annBounds.y_max,boundBox.y_max);annBounds.y_min=Math.min(annBounds.y_min,boundBox.y_min);}
var maxDistX=1.1*Math.max(Math.abs(annBounds.x_max-sigmaAvg),Math.abs(annBounds.x_min-sigmaAvg));var maxDistY=Math.max(annBounds.y_max,Math.abs(annBounds.y_min));var annBounds={x_max:sigmaAvg+maxDistX,x_min:sigmaAvg-maxDistX,y_max:maxDistY,y_min:-maxDistY};var xMax=Math.max(0,sigmaAvg+R,annBounds.x_max);var xMin=Math.min(0,sigmaAvg-R,annBounds.x_min);var xRange=xMax-xMin;var yMax=Math.max(0,R,annBounds.y_max);var yMin=Math.min(0,-R,annBounds.y_min);var yRange=yMax-yMin;canvas.x_axis.updateMinStaticBound(xMin-0.02*xRange);canvas.x_axis.updateMaxStaticBound(xMax+0.02*xRange);canvas.y_axis.updateMinStaticBound(yMin-0.02*yRange);canvas.y_axis.updateMaxStaticBound(yMax+0.02*yRange);canvas.size.setBoundsAndMargin();var txtOffsetY_IN=canvas.posConverter.convertValue_PxToIn(1,'Y');var txtOffsetX_IN=canvas.posConverter.convertValue_PxToIn(5,'X');canvas.addText(RL.Unicode.sigmaLower,new RL.Vector2(canvas.x_axis.maxDrawVal-txtOffsetX_IN,txtOffsetY_IN),{sizePX:14,ha:'end',va:'bottom'});canvas.addText(RL.Unicode.tauLower,new RL.Vector2(txtOffsetX_IN,canvas.y_axis.maxDrawVal-txtOffsetY_IN),{sizePX:14,ha:'start',va:'top'});}
this.drawPlaneAtAngle=function(canvas,angleDeg,title){var trnsStressX=this.getTransformedStress(angleDeg);var sigmaX=trnsStressX.sigmaTheta;var tauX=trnsStressX.tauTheta;var trnsStressY=this.getTransformedStress(angleDeg+90);var sigmaY=trnsStressY.sigmaTheta;var tauY=trnsStressY.tauTheta;var values=this.getExtremeValues();var maxStress=Math.max(Math.abs(values.prinStressMax),Math.abs(values.prinStressMin));var arrowLenMax=12;var arrowLenMin=3;var arrowLenX=arrowLenMin+(Math.abs(sigmaX)/maxStress)*(arrowLenMax-arrowLenMin);var arrowLenY=arrowLenMin+(Math.abs(sigmaY)/maxStress)*(arrowLenMax-arrowLenMin);var boxDim=10;var fillColor=RL.Color.RGB.fromColorName('FireBrick',0.3);var boxPts=[new RL.Vector2(0.5*boxDim,0.5*boxDim).rotate(angleDeg),new RL.Vector2(-0.5*boxDim,0.5*boxDim).rotate(angleDeg),new RL.Vector2(-0.5*boxDim,-0.5*boxDim).rotate(angleDeg),new RL.Vector2(0.5*boxDim,-0.5*boxDim).rotate(angleDeg)];canvas.addPolygon(boxPts,{edgeColor:'FireBrick',fillColor:fillColor.toString(),lineWidth:2});var tipPt_CSysX=new RL.Vector2(0.3*boxDim,0).rotate(angleDeg);canvas.addArrow(new RL.Vector2(0,0),tipPt_CSysX,{lineWidth:1,color:'Black',headLenPr:0.17,text:'x',textPosPr:0.99,textOffsetPX:10,textOptions:{sizePX:11}});var tipPt_CSysY=new RL.Vector2(0,0.3*boxDim).rotate(angleDeg);canvas.addArrow(new RL.Vector2(0,0),tipPt_CSysY,{lineWidth:1,color:'Black',headLenPr:0.17,text:'y',textPosPr:0.99,textOffsetPX:-10,textOptions:{sizePX:11}});var text_RL=RL.Unicode.sigmaLower+'.x = '+this.formatResult(sigmaX);var tipRL=(sigmaX>=0)?0.5*boxDim+arrowLenX:0.5*boxDim;var tailRL=(sigmaX>=0)?0.5*boxDim:0.5*boxDim+arrowLenX;var signX=RL.Number.sign(sigmaX)||1;var textPosPr_RL=signX>0?0.8:0.05;var tailPt_R=new RL.Vector2(tailRL,0).rotate(angleDeg);var tipPt_R=new RL.Vector2(tipRL,0).rotate(angleDeg);canvas.addArrow(tailPt_R,tipPt_R,{lineWidth:2,color:'Blue',headLenPr:0.15,text:text_RL,textPosPr:textPosPr_RL,textOffsetPX:signX*10,textOptions:{sizePX:12}});var tailPt_L=new RL.Vector2(-tailRL,0).rotate(angleDeg);var tipPt_L=new RL.Vector2(-tipRL,0).rotate(angleDeg);canvas.addArrow(tailPt_L,tipPt_L,{lineWidth:2,color:'Blue',headLenPr:0.15,text:text_RL,textPosPr:textPosPr_RL,textOffsetPX:-signX*10,textOptions:{sizePX:12}});var text_TB=RL.Unicode.sigmaLower+'.y = '+this.formatResult(sigmaY);var tipTB=(sigmaY>=0)?0.5*boxDim+arrowLenY:0.5*boxDim;var tailTB=(sigmaY>=0)?0.5*boxDim:0.5*boxDim+arrowLenY;var signY=RL.Number.sign(sigmaY)||1;var textPosPr_TB=signY>0?0.8:0.1;var tailPt_T=new RL.Vector2(0,tailTB).rotate(angleDeg);var tipPt_T=new RL.Vector2(0,tipTB).rotate(angleDeg);canvas.addArrow(tailPt_T,tipPt_T,{lineWidth:2,color:'Blue',headLenPr:0.15,text:text_TB,textPosPr:textPosPr_TB,textOffsetPX:signY*10,textOptions:{sizePX:12,ha:'end'}});var tailPt_B=new RL.Vector2(0,-tailTB).rotate(angleDeg);var tipPt_B=new RL.Vector2(0,-tipTB).rotate(angleDeg);canvas.addArrow(tailPt_B,tipPt_B,{lineWidth:2,color:'Blue',headLenPr:0.15,text:text_TB,textPosPr:textPosPr_TB,textOffsetPX:-signY*10,textOptions:{sizePX:12,ha:'end'}});var tauFix=-1;var signTauY=-1*RL.Number.sign(tauY)||1;var text_ShY=RL.Unicode.tauLower+' = '+this.formatResult(tauFix*tauY);var tipPt_ShT=new RL.Vector2(signTauY*0.4*boxDim,0.6*boxDim).rotate(angleDeg);var tailPt_ShT=new RL.Vector2(-signTauY*0.4*boxDim,0.6*boxDim).rotate(angleDeg);var textPosPR_ShT=signTauY>0?0.6:0.4;canvas.addArrow(tailPt_ShT,tipPt_ShT,{lineWidth:2,color:'Blue',headLenPr:0.15,text:text_ShY,textPosPr:textPosPR_ShT,textOffsetPX:signTauY*10,textOptions:{sizePX:12,ha:'start'}});var tipPt_ShB=tipPt_ShT.rotate(180);var tailPt_ShB=tailPt_ShT.rotate(180);var textPosPR_ShB=1-textPosPR_ShT;canvas.addArrow(tailPt_ShB,tipPt_ShB,{lineWidth:2,color:'Blue',headLenPr:0.15,text:text_ShY,textPosPr:textPosPR_ShB,textOffsetPX:signTauY*10,textOptions:{sizePX:12,ha:'start'}});var signTauX=1*RL.Number.sign(tauX)||1;var text_ShX=RL.Unicode.tauLower+' = '+this.formatResult(tauFix*tauX);var tipPt_ShR=new RL.Vector2(0.6*boxDim,signTauX*0.4*boxDim).rotate(angleDeg);var tailPt_ShR=new RL.Vector2(0.6*boxDim,-signTauX*0.4*boxDim).rotate(angleDeg);canvas.addArrow(tailPt_ShR,tipPt_ShR,{lineWidth:2,color:'Blue',headLenPr:0.15,text:text_ShX,textPosPr:0.8,textOffsetPX:-signTauX*10,textOptions:{sizePX:12}});var tipPt_ShL=tipPt_ShR.rotate(180);var tailPt_ShL=tailPt_ShR.rotate(180);canvas.addArrow(tailPt_ShL,tipPt_ShL,{lineWidth:2,color:'Blue',headLenPr:0.15,text:text_ShX,textPosPr:0.8,textOffsetPX:-signTauX*10,textOptions:{sizePX:12}});canvas.addTitle(title,{});canvas.options.padding={top:10,bottom:20,left:20,right:20};canvas.options.equalScaleFactors=true;}
this.printReport=function(){var trnsStressX=this.getTransformedStress(this.angleX);var trnsStressY=this.getTransformedStress(this.angleY);var extValues=this.getExtremeValues();var inputs={sigmaX:this.sigmaX,sigmaY:this.sigmaY,tau:__tau,rotDeg:__elemRotDeg};var results={rotStressX:{value:this.formatResult(trnsStressX.sigmaTheta),angle:this.formatResult(this.angleX)},rotStressY:{value:this.formatResult(trnsStressY.sigmaTheta),angle:this.formatResult(this.angleY)},rotShearStress:{value:this.formatResult(trnsStressX.tauTheta),angle:'---'},maxPrinStress:{value:this.formatResult(extValues.prinStressMax),angle:this.formatResult(extValues.angleDeg_MaxPrin)},minPrinStress:{value:this.formatResult(extValues.prinStressMin),angle:this.formatResult(extValues.angleDeg_MinPrin)},maxShearStress:{value:this.formatResult(extValues.shearStressMax),angle:this.formatResult(extValues.angleDeg_MaxShear)},minShearStress:{value:this.formatResult(extValues.shearStressMin),angle:this.formatResult(extValues.angleDeg_MinShear)}};var resDic={inputsStr:JSON.stringify(inputs),resultStr:JSON.stringify(results),plotMohrsCircle:this.getImgStr_MohrsCircle(),plotPlaneUnrotated:this.getImgStr_PlaneUnrotated(),plotPlaneRotated:this.getImgStr_PlaneRotated(),plotPlanePrincipalStress:this.getImgStr_PlanePrincipalStress(),plotPlaneMaxShear:this.getImgStr_PlaneMaxShear()};var url=routes.printReport;BF.HTTP.post(url,resDic);}
thisObj.init();}