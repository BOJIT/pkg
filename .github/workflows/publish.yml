name: publish

on:
  push:
    branches:
      - main

jobs:
  install:
    name: Copy install shell scripts to GitHub Pages branch
    runs-on: ubuntu-18.04

    steps:
    - name: Checkout main branch
      uses: actions/checkout@v2
      with:
        ref: main
        path: main
    - name: Checkout gh-pages branch
      uses: actions/checkout@v2
      with:
        ref: gh-pages
        path: gh-pages
    - name: Copy Install Shell Scripts
      run: |
        SCRIPTS=$(find main/install -type f -name "*.sh")
        echo ${SCRIPTS}

        TARGET=gh-pages/install
        if [ -d "${TARGET}"]; then
          rm -rf "${TARGET}"
        fi
        mkdir "${TARGET}"
    - name: ls
      run: ls -al gh-pages

  arch-pkg:
    name: Build Arch Linux packages and copy to GitHub Pages branch
    runs-on: ubuntu-18.04
    container:
      image: archlinux:latest

    steps:
    - name: Checkout main branch
      uses: actions/checkout@v2
      with:
        ref: main
        path: main
    - name: Checkout gh-pages branch
      uses: actions/checkout@v2
      with:
        ref: gh-pages
        path: gh-pages
    - name: ls
      run: ls
    # - name: Get list of packages that have changed
    #   run: find pkg/arch -type f -name "PKGBUILD"